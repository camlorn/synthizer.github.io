<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>A Basic Python Tutorial - The Synthizer Manual</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Tutorials</li><li class="chapter-item expanded "><a href="../tutorials/python.html" class="active"><strong aria-hidden="true">2.</strong> A Basic Python Tutorial</a></li><li class="chapter-item expanded affix "><li class="part-title">Concepts</li><li class="chapter-item expanded "><a href="../concepts/introduction.html"><strong aria-hidden="true">3.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../concepts/signal_graph.html"><strong aria-hidden="true">4.</strong> The Signal Graph, Library Parameters, and limitations</a></li><li class="chapter-item expanded "><a href="../concepts/conventions.html"><strong aria-hidden="true">5.</strong> C API Conventions</a></li><li class="chapter-item expanded "><a href="../concepts/initialization.html"><strong aria-hidden="true">6.</strong> Logging, Initialization, and Shutdown</a></li><li class="chapter-item expanded "><a href="../concepts/object_model.html"><strong aria-hidden="true">7.</strong> Objects, Handles, and Properties</a></li><li class="chapter-item expanded "><a href="../concepts/streams.html"><strong aria-hidden="true">8.</strong> Streams</a></li><li class="chapter-item expanded "><a href="../concepts/3d_panning.html"><strong aria-hidden="true">9.</strong> 3D Panning </a></li><li class="chapter-item expanded "><a href="../concepts/channel_mixing.html"><strong aria-hidden="true">10.</strong> Channel Upmixing and Downmixing </a></li><li class="chapter-item expanded affix "><li class="part-title">The Object Reference</li><li class="chapter-item expanded "><a href="../object_reference/context.html"><strong aria-hidden="true">11.</strong> Context</a></li><li class="chapter-item expanded "><a href="../object_reference/buffer.html"><strong aria-hidden="true">12.</strong> Buffer</a></li><li class="chapter-item expanded "><a href="../object_reference/source.html"><strong aria-hidden="true">13.</strong> Source (abstract)</a></li><li class="chapter-item expanded "><a href="../object_reference/spatialized_source.html"><strong aria-hidden="true">14.</strong> SpatializedSource (abstract)</a></li><li class="chapter-item expanded "><a href="../object_reference/panned_source.html"><strong aria-hidden="true">15.</strong> PannedSource</a></li><li class="chapter-item expanded "><a href="../object_reference/source_3d.html"><strong aria-hidden="true">16.</strong> Source3D</a></li><li class="chapter-item expanded "><a href="../object_reference/generator.html"><strong aria-hidden="true">17.</strong> Generator (abstract)</a></li><li class="chapter-item expanded "><a href="../object_reference/streaming_generator.html"><strong aria-hidden="true">18.</strong> StreamingGenerator</a></li><li class="chapter-item expanded "><a href="../object_reference/buffer_generator.html"><strong aria-hidden="true">19.</strong> BufferGenerator</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The Synthizer Manual</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#a-basic-python-tutorial" id="a-basic-python-tutorial">A Basic Python Tutorial</a></h1>
<h2><a class="header" href="#installation" id="installation">Installation</a></h2>
<p>We support Python 3.  Python wheels for Windows X64 are published to Pypi, so to install:</p>
<pre><code>pip install synthizer
</code></pre>
<p>Note that this won't currently work on 32-bit Python; this will be fixed.</p>
<h2><a class="header" href="#some-basics" id="some-basics">Some Basics</a></h2>
<p>Synthizer requires initialization and deinitialization. The best way to initialize Synthizer is to use the context manager:</p>
<pre><code>with synthizer.initialized():
    # Code...
</code></pre>
<p>The context manager will handle deinitialization on exceptions.  Though <code>synthizer.initialize()</code> and <code>synthizer.shutdown()</code> are exposed, use is discouraged as the context manager ensures clean shutdown in (almost) all cases.</p>
<p>Once the library is deinitialized, calls into Synthizer error.</p>
<h2><a class="header" href="#destroying-objects" id="destroying-objects">Destroying Objects</a></h2>
<p>Unlike the rest of Python, Synthizer objects represent concrete audio architecture, which need to have a defined lifetime in order to control when they are and aren't being heard,
and also to ensure that it can be well understood when things are and aren't using system resources.  To that end, Synthizer objects don't interact with Python garbage collection. When you're done with an object, call <code>myobj.destroy()</code>.</p>
<p>At the moment, failing to do so will permanently leak the object.  Work in future may lift this restriction, but it's still necessary to be explicit: if you aren't, things may be audioble longer than you intend.</p>
<h2><a class="header" href="#the-context" id="the-context">The Context</a></h2>
<p>Most objects in Synthizer require a context, which represents a listener in 3D space, an audio output device, and other miscellaneous infrastructure.
Objects are passed a context on construction, and two objects from different contexts never interact.</p>
<p>To get a context:</p>
<pre><code>ctx = synthizer.Context()
</code></pre>
<p>Currently, selecting audio output devices isn't supported, and audio will go to the system default.</p>
<h2><a class="header" href="#buffers-streams-and-generators" id="buffers-streams-and-generators">Buffers, Streams, and Generators</a></h2>
<p>As elaborated in the concepts section, the Synthizer audio graph is as follows:</p>
<ul>
<li>A source is fed by one or more generators and pans audio.</li>
<li>All the sources feed the context's output.</li>
</ul>
<p>Generators are an abstract concept, which represents somewhere audio comes from. Specific kinds of generators implement the abstract interface in a concrete fashion,
notably <code>BufferGenerator</code> (takes a buffer) and <code>StreamingGenerator</code> (takes streaming parameters).</p>
<p>Synthizer always gets audio from a stream.  Streams are specified as pre-parsed URL-like components:</p>
<ul>
<li>A protocol, <code>file</code> for example, which specifies where the audio comes from.</li>
<li>A path, which specifies where the audio is (i.e. path on disk, etc).</li>
<li>Options, of the form <code>key=value&amp;key=value&amp;...</code>.  At the moment, unused by anything, so just use <code>&quot;&quot;</code>.</li>
</ul>
<p>To play back a stream, you have two choices: you can use a <code>StreamingGenerator</code>, which takes these parameters directly and will decode in realtime, or you can use a <code>BufferGenerator</code>, which takes a pre-decoded buffer.</p>
<p>Buffers are in-memory decoded assets, essentially arrays of 16-bit samples resampled to Synthizer's samplerate. Note that they aren't actually contiguous arrays and are also immutable.</p>
<p>To get a streaming generator:</p>
<pre><code>generator = synthizer.StreamingGenerator(ctx, &quot;file&quot;, &quot;test.wav&quot;)
</code></pre>
<p>To get a buffer from a stream:</p>
<pre><code>buffer = synthizer.Buffer.from_stream(&quot;file&quot;, &quot;test.wav&quot;)
</code></pre>
<p>Note the following:</p>
<ul>
<li>Buffers aren't associated with a context and can be used anywhere,.</li>
<li>Buffers can be used simultaneously by multiple generators (or whatever else). You are encouraged to cache them and reuse them indefinitely.</li>
<li>When Synthizer needs to overload a constructor, it does so as staticmethods on the class. We don't have
multiple constructors here yet, but will in future.</li>
</ul>
<h2><a class="header" href="#sources" id="sources">Sources</a></h2>
<p>Sources represent audio output.  They get one or more generators, combine them all, and output.  Currently we have the following kinds of sources:</p>
<ul>
<li>A PannedSource is manually controlled using azimuth and elevation or, alternatively, a panning scalar.</li>
<li>Source3D is a 3D environmental source with the usual things you'd expect: distance model, position, etc.</li>
</ul>
<h2><a class="header" href="#properties" id="properties">Properties</a></h2>
<p>Synthizer offers the following kinds of properties:</p>
<ul>
<li>int, represented as either a Python integer type or an enum. An example of the latter case is <code>source.distance_model</code>, which is a <code>synthizer.DistanceModel</code>. Synthizer exposes enums as Python 3.4-style enums via Cython.</li>
<li>Double, which is self-explanatory.</li>
<li>Double3, which is a tuple of 3 doubles. Usually used as a position.</li>
<li>Double6, a tuple of 6 doubles. Usually used as an orientation (given a dedicated section below).</li>
<li>Object, i.e. <code>buffer_generator.buffer = b</code>.</li>
</ul>
<p>Property writing is very fast.  Property reading is incredibly slow and won't be improved.  Code like the following is a terrible idea:</p>
<pre><code>myobj.property += 5
</code></pre>
<p>The above hides a number of C API details elaborated on elsewhere in this document.  In addition to being slow, future changes to the library may cause it to not do what you expect.  In general, try to derive Synthizer properties from values you already have.  As a concrete example of what Synthizer reserves the right to break, code like the following may stop working in future:</p>
<pre><code>myobj.property = 0
myobj.property += 5
myobj.property += 5
# May fail in future
assert myobj.property == 10
</code></pre>
<p>Most object properties are internally referenced in a weak fashion. That is to say that destroying (<code>.destroy()</code>)the object the property is set to will clear the property. In the occasional instance that this isn't the case,
destroying the object externally will destroy your references to it, but Synthizer will keep using the value until another is set. If that happens, the property returns None.  As of this writing, no strong object properties exist.</p>
<p>Synthizer translates <code>SYZ_P_MY_PROPERTY</code> to <code>obj.my_property</code>. The translations of the tables in the object reference are nearly mechanical.</p>
<h2><a class="header" href="#an-aside-orientation-formulas" id="an-aside-orientation-formulas">An aside: orientation formulas</a></h2>
<p>Before going much further, most people seem to eventually ask about trigonometry with respect to using a 3D audio library for 2D games. The high level overview
for those who already know trigonometry is that Synthizer's coordinate system is right-handed and orientations consist of 2 orthogonal unit vectors <code>(atx, aty, atz, upx, upy, upz)</code> stored
as a packed property so that they can both be set atomically.  But the longer version for those who don't know trigonometry is:</p>
<p>Degrees to radians is:</p>
<pre><code>import math

def deg2rad(angle):
    return (angle / 180.0) * math.pi
</code></pre>
<p>People who don't know trig usually ask for orientations that are clockwise of north. To do that:</p>
<pre><code>import math

def make_orientation(degrees):
    rad = deg2rad(angle)
    return (math.sin(rad), math.cos(rad), 0, 0, 0, 1)
</code></pre>
<p>Setting <code>context.orientation</code> to the result of the above will set things up so that you can treat positive x as east, positive y as north, and positive z as up. The default orientation faces the listener north.</p>
<h2><a class="header" href="#putting-it-together" id="putting-it-together">Putting it Together</a></h2>
<p>To play a source in 3D space, do the following:</p>
<ul>
<li>Create a context.</li>
<li>Create a source.</li>
<li>Create a buffer.</li>
<li>Create a generator.</li>
<li><code>generator.buffer = buffer</code></li>
<li><code>source.add_generator(generator)</code></li>
<li>Then manipulate position, etc. on the source.</li>
</ul>
<h2><a class="header" href="#a-worked-example" id="a-worked-example">A Worked Example</a></h2>
<p>The following is a 3D media player, the audio library equivalent of hello world. It supports the following commands:</p>
<ul>
<li><code>pause</code>, <code>play</code>: pause/play the source. Note that these are currently implemented via generator add/remove, but a better way is coming.</li>
<li><code>seek &lt;seconds&gt;</code>: self-explanatory.</li>
<li><code>pos &lt;x&gt; &lt;y&gt; &lt;z&gt;</code>: move the source. X is right, y is forward, z is up.</li>
<li><code>quit</code>: self-explanatory.</li>
</ul>
<p>Note that the default distance model parameters cause the source to become completely silent at around 50 units out. Movements close to the head won't change the volume much. Also, HRTF improvements are coming.</p>
<p>This example also doesn't demonstrate destruction, as that's handled by library deinitialization and process shutdown. A proper program needs <code>source.destroy()</code> etc for dynamic sources, as explained above.</p>
<p>The code:</p>
<pre><code>&quot;&quot;&quot;A simple media player, demonstrating the Synthizer basics.&quot;&quot;&quot;

import synthizer
import time
import sys

if len(sys.argv) != 2:
    print(&quot;Usage: example.py &lt;file&gt;&quot;)
    sys.exit(1)

# Log to debug. At the moment this writes directly to stdout, but will in future integrate with Python's logging modules.
# It's best to call this before any initialization.
synthizer.configure_logging_backend(synthizer.LoggingBackend.STDERR)
synthizer.set_log_level(synthizer.LogLevel.DEBUG)

with synthizer.initialized():
    # Get our context, which almost everything requires.
    # This starts the audio threads.
    ctx = synthizer.Context()

    # A BufferGenerator plays back a buffer:
    generator = synthizer.BufferGenerator(context=ctx)
    # A buffer holds audio data. We read from the specified file:
    buffer = synthizer.Buffer.from_stream(ctx, protocol=&quot;file&quot;, path=sys.argv[1])
    # Tell the generator to use the buffer.
    generator.buffer = buffer
    # A Source3D is a 3D source, as you'd expect.
    source = synthizer.Source3D(ctx)
    # It'll play the BufferGenerator.
    source.add_generator(generator)
    playing = True

    # A simple command parser.
    while True:
        cmd = input(&quot;Command: &quot;)
        cmd = cmd.split()
        if len(cmd) == 0:
            continue
        if cmd[0] == &quot;pause&quot;:
                # We don't have proper pausing yet, but can simulate it
                if playing:
                    source.remove_generator(generator)
                    playing = False
        elif cmd[0] == &quot;play&quot;:
            if not playing:
                source.add_generator(generator)
                playing = True
        elif cmd[0] == &quot;pos&quot;:
            if len(cmd) &lt; 4:
                print(&quot;Syntax: pos x y z&quot;)
                continue
            try:
                x, y, z = [float(i) for i in cmd[1:]]
            except:
                print(&quot;Unable to parse coordinates&quot;)
                continue
            source.position = (x, y, z)
        elif cmd[0] == &quot;seek&quot;:
            if len(cmd) != 2:
                print(&quot;Syntax: pos &lt;seconds&gt;&quot;)
            try:
                pos = float(cmd[1])
            except:
                print(&quot;Unable to parse position&quot;)
            generator.position = pos
        elif cmd[0] == &quot;quit&quot;:
            break
        else:
            print(&quot;Unrecognized command&quot;)
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../concepts/introduction.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../concepts/introduction.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
